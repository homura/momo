(this.webpackJsonpmomo=this.webpackJsonpmomo||[]).push([[0],{188:function(e,t,n){e.exports=n(373)},193:function(e,t,n){},196:function(e,t,n){},373:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(5),c=n.n(i),o=(n(193),n(194),n(122)),l=n(15),u=(n(196),n(197),n(173)),s=(n(60),n(13)),m=(n(200),n(119)),f=(n(127),n(38)),d=n(10),p=n.n(d),b=n(24),v=n(153),h=n.n(v);var y,x=n(55),w=n(80),g=n(115),E=n(154);!function(e){e.Pending="Pending",e.Fulfilled="Fulfilled",e.Rejected="Rejected"}(y||(y={}));var k={editor:{rawData:"",data:[],dataStatus:y.Fulfilled,dataTitle:"untitled",columns:[],comparison:"",dimension:"",metric:"",isEditorSetup:Object(l.c)((function(e){var t=e.data;return Array.isArray(t)&&t.length>0})),setupEditor:Object(l.b)((function(e,t){var n=t.data,a=t.columns,r=t.dimension,i=t.metric,c=t.comparison,o=t.dataTitle,l=t.rawData;e.rawData=l,e.data=n.map((function(e){return Object(g.a)(Object(g.a)({},e),{},Object(w.a)({},i,Number(e[i])))})),e.columns=a,e.dimension=r,e.comparison=c,e.metric=i,e.dataTitle=o})),switchDimension:Object(l.b)((function(e,t){e.dimension=t})),switchComparison:Object(l.b)((function(e,t){e.comparison=t})),switchMetric:Object(l.b)((function(e,t){e.metric=t})),loadCSV:Object(l.f)(function(){var e=Object(b.a)(p.a.mark((function e(t,n){var a,r,i,c,o,l,u,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(E.parse)(n.csvText,{header:!0,skipEmptyLines:!0}),r=a.meta,i=a.data,c=r.fields,o=Object(x.a)(c,3),l=o[0],u=o[1],s=o[2],t.setupEditor({rawData:n.csvText,columns:c,data:i,dimension:l,comparison:u,metric:s,dataTitle:n.name});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),loadCSVFile:Object(l.f)(function(){var e=Object(b.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var t=new FileReader;t.onload=function(t){e(t.target.result)},t.readAsText(n)}));case 2:a=e.sent,t.loadCSV({csvText:a,name:n.name.split(".")[0]});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}},O=Object(l.d)(k),j=Object(l.e)(),C=j.useStoreActions,S=(j.useStoreDispatch,j.useStoreState),A=n(376),T=n(39),D=n(86);function K(e){var t=0,n=String(e);if(!n)return"#000000";for(var a=0;a<n.length;a++)t=n.charCodeAt(a)+((t<<5)-t),t&=t;for(var r="#",i=0;i<3;i++){r+=("00"+(t>>8*i&255).toString(16)).substr(-2)}return r}var V=function(){var e=S((function(e){return e.editor})),t=Object(a.useRef)(),n=Object(a.useCallback)((function(e){null!==e&&(t.current=function(e){var t,n=T.f(e),a="stop";function r(){console.log(n.selectAll("*")),n.selectAll("*").remove()}function i(){return(i=Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="stop",r();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return(c=Object(b.a)(p.a.mark((function e(r,i){var c,o,l,u,s,m,f,d,b,v;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d=function(){return"start"===a},c=function(e){return D.get(e,i.mainDimensionKey)},o=function(e){return D.get(e,i.dimensionKey)},l=function(e){return D.get(e,i.metricKey)},u={top:30,right:80,bottom:30,left:20},n.append("text").attr("class","dimension-main").style("font-size","64px").attr("text-anchor","end").attr("x",960-u.right).attr("y",540-u.bottom).attr("fill","#eee").attr("stroke","#333"),s=T.a().key(c).sortKeys((function(e,t){return e.localeCompare(t)})).sortValues((function(e,t){return Number(t[i.metricKey])-Number(e[i.metricKey])})).entries(r),m=T.e().range([0,960-u.left-u.right]),f=T.d().range([0,540-u.top-u.bottom]).paddingInner(.2).padding(.3),a="start",b=p.a.mark((function e(r){var c,u,b,v,h,y,x,w;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d()){e.next=2;break}return e.abrupt("return","break");case 2:if(t=T.g().duration(750),c=s[r],u=c.values.slice(0,10),b=l(null===u||void 0===u?void 0:u[0]),m.domain([0,b]),f.domain(T.b(u.length)),n.select(".dimension-main").text(c.key),v=n.selectAll(".bar").data(u,o),h=n.selectAll(".label-dimension").data(u,o),y=n.selectAll(".label-metric").data(u,o),v.enter().append("rect").attr("class","bar").attr("x",0).attr("y",540).attr("fill",(function(e){return K(e[i.dimensionKey])})).attr("height",f.bandwidth()).attr("fill-opacity",1e-6).merge(v).transition(t).attr("y",(function(e,t){return f(t)})).attr("width",(function(e){return m(l(e))})).attr("height",f.bandwidth()).attr("fill-opacity",1),x=function(e){return e.attr("y",540).attr("alignment-baseline","central").attr("opacity",1e-6).attr("stroke",(function(e){return T.c(K(o(e))).brighter().formatHex()})).style(" stroke-linecap","butt").attr("fill","#fff").style("font-size","28px").attr("text-anchor","end")},h.enter().append("text").attr("class","label-dimension").call(x).text(o).merge(h).transition(t).attr("opacity",1).attr("y",(function(e,t){return f(t)+f.bandwidth()/2})).attr("x",(function(e){return m(l(e))-10})),y.enter().append("text").call(x).attr("text-anchor","start").attr("class","label-metric").style("font-size","24px").merge(y).transition(t).textTween((function(e,t){var n,a,i,c=null!==(n=l(null===s||void 0===s||null===(a=s[r-1])||void 0===a||null===(i=a.values)||void 0===i?void 0:i[t]))&&void 0!==n?n:0,o=l(e);return function(e){return Math.ceil(c+(o-c)*e)}})).attr("opacity",1).attr("y",(function(e,t){return f(t)+f.bandwidth()/2})).attr("x",(function(e){return m(l(e))+10})),w=function(e){return e.attr("opacity",1).attr("fill-opacity",1).transition(t).attr("y",540).attr("opacity",1e-6).attr("fill-opacity",1e-6).remove()},v.exit().call(w),h.exit().call(w),y.exit().call(w),!t||"start"!==a){e.next=31;break}return e.prev=21,e.next=24,t.end();case 24:e.next=29;break;case 26:return e.prev=26,e.t0=e.catch(21),e.abrupt("return","break");case 29:e.next=32;break;case 31:return e.abrupt("return","break");case 32:case"end":return e.stop()}}),e,null,[[21,26]])})),v=0;case 12:if(!(v<s.length)){e.next=20;break}return e.delegateYield(b(v),"t0",14);case 14:if("break"!==e.t0){e.next=17;break}return e.abrupt("break",20);case 17:v++,e.next=12;break;case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{render:function(e,t){return c.apply(this,arguments)},remove:r,stop:function(){return i.apply(this,arguments)}}}(e),i())}),[e.comparison,e.data,e.dimension,e.metric]);function i(){t.current.render(e.data,{dimensionKey:e.comparison,mainDimensionKey:e.dimension,metricKey:e.metric})}function c(){return(c=Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.current.stop();case 2:i();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,e.dataTitle),r.a.createElement("svg",{ref:n,viewBox:"0 0 960 540"}),r.a.createElement(s.a,{size:"small",icon:r.a.createElement(A.a,null),onClick:function(){return c.apply(this,arguments)},title:"replay"}))},I=(n(251),n(45)),F=(n(253),n(58)),z=(n(255),n(175)),R=(n(257),n(176).a.TextArea),B=function(e){var t=S((function(e){return e.editor.rawData})),n=C((function(e){return e.editor.loadCSV})),i=Object(a.useState)(""),c=Object(x.a)(i,2),o=c[0],l=c[1];return Object(a.useEffect)((function(){l(t)}),[t]),r.a.createElement(z.a,{visible:e.visible,onCancel:e.onCancel,title:"CSV",onOk:function(){n({csvText:o,name:""})}},r.a.createElement(R,{rows:10,value:o,onChange:function(e){return l(e.target.value)}}))},M=function(){var e=S((function(e){return e.editor})),t=e.comparison,n=e.metric,i=e.dimension,c=e.dataTitle,o=Object(a.useState)(!1),l=Object(x.a)(o,2),u=l[0],m=l[1];return r.a.createElement("div",null,r.a.createElement(B,{visible:u,onCancel:function(){return m(!1)}}),r.a.createElement(F.a,{layout:"vertical"},r.a.createElement(F.a.Item,{label:"data"},r.a.createElement(s.a,{onClick:function(){return m(!0)}},c||"data")),r.a.createElement(F.a.Item,{label:"dimension"},r.a.createElement(I.a,{value:i},r.a.createElement(I.a.Option,{key:i,value:i},i))),r.a.createElement(F.a.Item,{label:"comparison"},r.a.createElement(I.a,{value:t},r.a.createElement(I.a.Option,{value:t},t))),r.a.createElement(F.a.Item,{label:"metric"},r.a.createElement(I.a,{value:n},r.a.createElement(I.a.Option,{value:n},n)))))},N=n(172),P=function(){var e=C((function(e){return e.editor.loadCSV})),t=S((function(e){return e.editor})).isEditorSetup;Object(a.useEffect)((function(){(function(){var t=Object(b.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://gist.githubusercontent.com/homura/8c7329eeece508c603e107bf219c7e62/raw/aefb8405ea8938f57026b8538432f5f172443889/COVID-USA.csv").then((function(e){return e.text()}));case 2:n=t.sent,console.log(Object(N.parse)(window.location.search)),e({csvText:n,name:"COVID-19-USA"});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]);return r.a.createElement(u.a,null,r.a.createElement(m.a,{span:18,style:{padding:"16px"}},t?r.a.createElement(V,null):r.a.createElement(f.a,null)),r.a.createElement(m.a,{span:6,style:{padding:"16px"}},r.a.createElement(M,null),r.a.createElement("div",null,r.a.createElement(s.a,{type:"link",size:"small",onClick:function(){var e=new File([],"demo.csv",{type:"text/csv;charset=utf-8"});h.a.saveAs(e)}},"download demo.csv"))))},J=o.a.Content;var U=function(){return r.a.createElement(l.a,{store:O},r.a.createElement(o.a,null,r.a.createElement(J,null,r.a.createElement(P,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[188,1,2]]]);